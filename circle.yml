machine:
  java:
    version: oraclejdk8

dependencies:
  pre:
    - sudo apt-get install dos2unix
    - mysql -u root --execute="SET PASSWORD FOR 'root'@'localhost' = PASSWORD('passwd00')"
    - sudo apt-add-repository -y 'deb http://ppa.launchpad.net/ondrej/mysql-experimental/ubuntu precise main'
    - sudo apt-get update
    - sudo DEBIAN_FRONTEND=noninteractive apt-get install -y mysql-server-5.6
    - cd conf; sudo /bin/sh setup.sh
    - cd /tmp/openiam/schema/mysql; sudo ./execute.sh passwd00 new_install
  override:
    - mvn install -s conf/settings.xml
    - mvn package spring-boot:repackage -f openiam-esb/pom.xml
test:
  post:
    - ls -al
deployment:
  development:
    branch: development
    commands:
       - /bin/sh conf/deploy.sh